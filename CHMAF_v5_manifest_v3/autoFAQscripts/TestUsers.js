var win_TestUsers = // –æ–ø–∏—Å–∞–Ω–∏–µ –æ–∫–Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    `<div style="display: flex;">
        <span style="cursor: -webkit-grab; margin:7px;">
            <input id="iduserinfo" placeholder="ID –£/–ü" title="–í–≤–µ–¥–∏—Ç–µ ID –£/–ü –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏" class="teststudteachinp darkinputs" autocomplete="off" type="text">
            <button id="openuserinfo" title="–û—Ç–∫—Ä—ã—Ç—å User Info —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ id" class="mainButton teststudteach">üîç</button>
            <br>
            <button id="sidcode" title="–ü—Ä–∏ –∫–ª–∏–∫–µ –õ–ö–ú –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –ª–æ–≥–∏–Ω–µ—Ä –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —É—á–µ—Ç–∫—É —Å –∑–∞—Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É—á–µ–Ω–∏–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏ –∫–æ–ø–∏—Ä—É–µ—Ç –µ–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. –ü—Ä–∏ –∫–ª–∏–∫–µ –ü–ö–ú –∫–æ–ø–∏—Ä—É–µ—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ ID —É—á–µ–Ω–∏–∫–∞, –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –≤ –∞–¥–º–∏–Ω–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Ä–æ–∫–æ–≤." class="mainButton teststudteach" style="margin-left:2px">üë®‚Äçüéì</button>
            <button id="tidcode" title="–ü—Ä–∏ –∫–ª–∏–∫–µ –õ–ö–ú –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –ª–æ–≥–∏–Ω–µ—Ä –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —É—á–µ—Ç–∫—É —Å –∑–∞—Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏ –∫–æ–ø–∏—Ä—É–µ—Ç –µ–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. –ü—Ä–∏ –∫–ª–∏–∫–µ –ü–ö–ú –∫–æ–ø–∏—Ä—É–µ—Ç –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ ID –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –≤ –∞–¥–º–∏–Ω–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Ä–æ–∫–æ–≤." class="mainButton teststudteach">üëΩ</button>
            <button id="TestRooms" class="mainButton teststudteach" title="–û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Ä–æ–∫–æ–≤">üé≤</button>
            <button id="link2lessbtn" class="mainButton teststudteach" title="–û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —É—Ä–æ–∫">üìü</button>
            <div id="addInfoUser" style="color: white; text-align: center; cursor: -webkit-grab;"></div>
        </span>
    </div>
    `;

const TestUsersdiv = createWindow('TestUsers', 'winTopTestUsers', 'winLeftTestUsers', win_TestUsers);
const addInfoUser = document.getElementById('addInfoUser');
const btnsid = document.getElementById('sidcode');
const btntid = document.getElementById('tidcode');
const idUserInfoInput = document.getElementById('iduserinfo');
const openUserInfoButton = document.getElementById('openuserinfo');

document.getElementById('TestRooms').onclick = getTestRoomsButtonPress;
document.getElementById('link2lessbtn').onclick = getlink2lessButtonPress;

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –∫–Ω–æ–ø–æ–∫
function handleButtonClick(buttonId, storageKey) {
    const userId = localStorage.getItem(storageKey);
    if (!userId) return;
    const button = document.getElementById(buttonId);
    button.classList.add('active');

    getLoginLink(userId).then(() => {
        button.classList.remove('active'); // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å active
        button.classList.add('successbtn'); // –î–æ–±–∞–≤–ª—è–µ–º successbtn
        setTimeout(() => button.classList.remove('successbtn'), 1000);
    }).catch((error) => {
        console.log('–û—à–∏–±–∫–∞: ', error);
        button.classList.remove('active'); // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å active
        button.classList.add('errorbtn'); // –î–æ–±–∞–≤–ª—è–µ–º errorbtn
        setTimeout(() => button.classList.remove('errorbtn'), 1000);
    });
}

// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ ID –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function handleContextMenu(event, storageKey, buttonId) {
    event.preventDefault();
    const userId = localStorage.getItem(storageKey);
    const button = document.getElementById(buttonId);
    if (userId) {
        copyToClipboard(userId);
        createAndShowButton('üíæ ID c–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ');
        button.classList.add('successbtn'); // –î–æ–±–∞–≤–ª—è–µ–º successbtn
        setTimeout(() => button.classList.remove('successbtn'), 1000);
    } else {
        alert("–í–≤–µ–¥–∏—Ç–µ ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É—á–µ–Ω–∏–∫–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ‚öô");
    }
}

// –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫ –∫–Ω–æ–ø–∫–∞–º
btnsid.addEventListener("click", () => handleButtonClick('sidcode', 'test_stud'));
btnsid.addEventListener("contextmenu", (event) => handleContextMenu(event, 'test_stud', 'sidcode'));

btntid.addEventListener("click", () => handleButtonClick('tidcode', 'test_teach'));
btntid.addEventListener("contextmenu", (event) => handleContextMenu(event, 'test_teach', 'tidcode'));

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å—Ç–∞–≤–∫–∏, –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —á–∏—Å–µ–ª –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
function handleInput(event) {
    idUserInfoInput.value = '';
    const pastedValue = (event.clipboardData || event.dataTransfer).getData('text').trim();
    setTimeout(() => {
        if (/^\d+$/.test(pastedValue)) {
            idUserInfoInput.value = pastedValue;
            openUserInfoButton.click();
        }
    }, 0);
}

idUserInfoInput.addEventListener('paste', handleInput);
idUserInfoInput.addEventListener('drop', handleInput);
idUserInfoInput.addEventListener('input', () => onlyNumber(idUserInfoInput));

// –û—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ User Info
openUserInfoButton.onclick = () => {
    const idforinfo = idUserInfoInput.value.trim();
    if (idforinfo) {
        const serviceElement = document.getElementById('AF_Service');
        if (serviceElement.style.display === 'none') {
            serviceElement.style.display = '';
            document.getElementById('butServ').classList.add('activeScriptBtn');
        }
        document.getElementById('idstudent').value = idforinfo;
        document.getElementById('getidstudent').click();
        idUserInfoInput.value = '';
    }
};

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∏–ª—è –¥–ª—è TestUsersdiv
const TestUsersdivstyle = (window.location.host === "skyeng.autofaq.ai" && window.location.pathname !== "/login") && localStorage.getItem('disablelpmwindow') !== '1' ? '' : 'none';
setDisplayStyle(TestUsersdiv, TestUsersdivstyle);
