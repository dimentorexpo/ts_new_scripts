var win_TestUsers = // Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾ĞºĞ½Ğ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
    `<div style="display: flex;">
        <span style="cursor: -webkit-grab; margin:7px;">
            <input id="iduserinfo" placeholder="ID Ğ£/ĞŸ" title="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ID Ğ£/ĞŸ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸" class="teststudteachinp darkinputs" autocomplete="off" type="text">
            <button id="openuserinfo" title="ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ User Info ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ id" class="mainButton teststudteach">ğŸ”</button>
            <br>
            <button id="sidcode" title="ĞŸÑ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ›ĞšĞœ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑÑ‹Ğ»ĞºÑƒ Ğ»Ğ¾Ğ³Ğ¸Ğ½ĞµÑ€ Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² ÑƒÑ‡ĞµÑ‚ĞºÑƒ Ñ Ğ·Ğ°Ñ€Ğ°Ğ½ĞµĞµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğ¼ ID Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ° Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… Ğ¸ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ ĞµĞµ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°. ĞŸÑ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ ĞŸĞšĞœ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° ID ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ°, Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… ÑƒÑ€Ğ¾ĞºĞ¾Ğ²." class="mainButton teststudteach" style="margin-left:2px">ğŸ‘¨â€ğŸ“</button>
            <button id="tidcode" title="ĞŸÑ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ›ĞšĞœ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑÑ‹Ğ»ĞºÑƒ Ğ»Ğ¾Ğ³Ğ¸Ğ½ĞµÑ€ Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² ÑƒÑ‡ĞµÑ‚ĞºÑƒ Ñ Ğ·Ğ°Ñ€Ğ°Ğ½ĞµĞµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğ¼ ID Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… Ğ¸ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ ĞµĞµ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°. ĞŸÑ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ ĞŸĞšĞœ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° ID Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ñ, Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… ÑƒÑ€Ğ¾ĞºĞ¾Ğ²." class="mainButton teststudteach">ğŸ‘½</button>
            <button id="TestRooms" class="mainButton teststudteach" title="ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¾ĞºĞ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… ÑƒÑ€Ğ¾ĞºĞ¾Ğ²">ğŸ²</button>
            <button id="link2lessbtn" class="mainButton teststudteach" title="ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¾ĞºĞ½Ğ¾ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑÑÑ‹Ğ»ĞºĞ¸ Ğ½Ğ° ÑƒÑ€Ğ¾Ğº">ğŸ“Ÿ</button>
            <div id="addInfoUser" style="color: white; text-align: center; cursor: -webkit-grab;"></div>
        </span>
    </div>
    `;

const TestUsersdiv = createWindow('TestUsers', 'winTopTestUsers', 'winLeftTestUsers', win_TestUsers);
const addInfoUser = document.getElementById('addInfoUser');
const btnsid = document.getElementById('sidcode');
const btntid = document.getElementById('tidcode');
const idUserInfoInput = document.getElementById('iduserinfo');
const openUserInfoButton = document.getElementById('openuserinfo');

document.getElementById('TestRooms').onclick = getTestRoomsButtonPress;
document.getElementById('link2lessbtn').onclick = getlink2lessButtonPress;

// Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº
function handleButtonClick(buttonId, storageKey) {
    const userId = localStorage.getItem(storageKey);
    if (!userId) return;
    const button = document.getElementById(buttonId);
    button.classList.add('active');

    getLoginLink(userId).then(() => {
        button.classList.remove('active'); // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ ĞºĞ»Ğ°ÑÑ active
        button.classList.add('successbtn'); // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ successbtn
        createAndShowButton('ğŸ’¾ Ğ¡ÑÑ‹Ğ»ĞºĞ°-Ğ»Ğ¾Ğ³Ğ¸Ğ½ĞµÑ€ cĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°', 'message');
        setTimeout(() => button.classList.remove('successbtn'), 1000);
    }).catch((error) => {
        console.log('ĞÑˆĞ¸Ğ±ĞºĞ°: ', error);
        button.classList.remove('active'); // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ ĞºĞ»Ğ°ÑÑ active
        button.classList.add('errorbtn'); // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ errorbtn
        createAndShowButton('ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑÑ‹Ğ»ĞºÑƒ-Ğ»Ğ¾Ğ³Ğ¸Ğ½ĞµÑ€', 'error');
        setTimeout(() => button.classList.remove('errorbtn'), 1000);
    });
}

// ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ID Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
function handleContextMenu(event, storageKey, buttonId) {
    event.preventDefault();
    const userId = localStorage.getItem(storageKey);
    const button = document.getElementById(buttonId);
    if (userId) {
        copyToClipboard(userId);
        createAndShowButton('ğŸ’¾ ID cĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾', 'message');
        button.classList.add('successbtn'); // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ successbtn
        setTimeout(() => button.classList.remove('successbtn'), 1000);
    } else {
        createAndShowButton('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ID Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ÑƒÑ‡ĞµĞ½Ğ¸ĞºĞ° Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… âš™', 'error');
    }
}

// ĞŸÑ€Ğ¸Ğ²ÑĞ·ĞºĞ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğº ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ğ¼
btnsid.addEventListener("click", () => handleButtonClick('sidcode', 'test_stud'));
btnsid.addEventListener("contextmenu", (event) => handleContextMenu(event, 'test_stud', 'sidcode'));

btntid.addEventListener("click", () => handleButtonClick('tidcode', 'test_teach'));
btntid.addEventListener("contextmenu", (event) => handleContextMenu(event, 'test_teach', 'tidcode'));

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ¸, Ğ¿ĞµÑ€ĞµÑ‚Ğ°ÑĞºĞ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‡Ğ¸ÑĞµĞ» Ğ² Ğ¿Ğ¾Ğ»Ğµ Ğ²Ğ²Ğ¾Ğ´Ğ°
function handleInput(event) {
    idUserInfoInput.value = '';
    const pastedValue = (event.clipboardData || event.dataTransfer).getData('text').trim();
    setTimeout(() => {
        if (/^\d+$/.test(pastedValue)) {
            idUserInfoInput.value = pastedValue;
            openUserInfoButton.click();
        }
    }, 0);
}

idUserInfoInput.addEventListener('paste', handleInput);
idUserInfoInput.addEventListener('drop', handleInput);
idUserInfoInput.addEventListener('input', () => onlyNumber(idUserInfoInput));

// ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¾ĞºĞ½Ğ° User Info
openUserInfoButton.onclick = () => {
    const idforinfo = idUserInfoInput.value.trim();
    if (idforinfo) {
        const serviceElement = document.getElementById('AF_Service');
        if (serviceElement.style.display === 'none') {
            serviceElement.style.display = '';
            document.getElementById('butServ').classList.add('activeScriptBtn');
        }
        document.getElementById('idstudent').value = idforinfo;
        document.getElementById('getidstudent').click();
        idUserInfoInput.value = '';
    }
};

// Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑÑ‚Ğ¸Ğ»Ñ Ğ´Ğ»Ñ TestUsersdiv
// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¸Ğ»Ñ
function updateTestUsersDivStyle() {
    const isHostCorrect = window.location.host === "skyeng.autofaq.ai";
    const isNotLogin = window.location.pathname !== "/login";
    const isAllowed = localStorage.getItem('disablelpmwindow') !== '1';

    const shouldShow = isHostCorrect && isNotLogin && isAllowed;
    setDisplayStyle(TestUsersdiv, shouldShow ? '' : 'none');
}

// ĞŸĞµÑ€Ğ²Ğ¾Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ
updateTestUsersDivStyle();

// Ğ•ÑĞ»Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° - /login, Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ
if (window.location.pathname === "/login") {
    const styleCheckInterval = setInterval(() => {
        if (window.location.pathname !== "/login") {
            updateTestUsersDivStyle();
            clearInterval(styleCheckInterval);
        }
    }, 500);
}