var win_AFhelper =  // –æ–ø–∏—Å–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
    `<div style="width: 351px;">
        <span style="width: 351px">
			<span style="cursor: -webkit-grab;">
				<div style="margin: 5px;" id="1str">
					<button class="mainButton" id="languageAF" title="–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —è–∑—ã–∫ –†—É—Å—Å–∫–∏–π/–ê–Ω–≥–ª–∏–π—Å–∫–∏–π" style="width:100px">–†—É—Å—Å–∫–∏–π</button>
                    <button id="testCustTMPL" class="mainButton" title="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–≤–æ–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤ –ª–∏–±–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —è—á–µ–π–∫–∏ –≤ —ç—Ç–æ–º –ø–æ–ª–µ">üìí</button>
					<button class="mainButton buttonHide" id="hideMenuMain" title="–°–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –¥—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ–∫–æ–Ω" style="margin-left:18px;">hide</button>
					<button class="mainButton" id="setting" title="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –±—É–¥–∏–ª—å–Ω–∏–∫–∞" style="width:23px; float: right; margin-right: 5px">‚öô</button>
					<button class="mainButton" id="links" title="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–ø.–º–µ–Ω—é —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏" style="width:16px; float: right; margin-right: 5px">L</button>
					<button id="addsrc" class="mainButton onlyfortp" title="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–ø –º–µ–Ω—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏ —à–∫–æ–ª—ã, —Ç—Ä–µ–±—É—é—â–∏–º–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–¥–∞—á—É –¥–æ—Å—Ç—É–ø–∞" style="width:16px; float: right; margin-right: 5px">*</button>
					<button class="mainButton" id="getnewtmpldata" title="–û–±–Ω–æ–≤–ª—è–µ—Ç —à–∞–±–ª–æ–Ω—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å —à–∞–±–ª–æ–Ω–∞–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏" style="width:27px; float: right; margin-right: 5px">üîÑ</button>
					<button class="mainButton" id="reminderstatus" title="–°—Ç–∞—Ç—É—Å –±—É–¥–∏–ª—å–Ω–∏–∫–∞ üîî - –≤–∫–ª, üîï - –≤—ã–∫–ª" style="width:25px; float: right; margin-right: 5px"></button>
					<input id ="phone_tr" class="onlyfortp ${exttheme}" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" autocomplete="off" type="text" style = "text-align: center; width: 150px; margin-left: 15px; margin-top: 5px; border-radius: 10px;"></input>
                    <input id ="email_tr" class="onlyfortp ${exttheme}" placeholder="–ü–æ—á—Ç–∞" autocomplete="off" type="text" style = "text-align: center; width: 150px; margin-left: 12px; margin-top: 5px; border-radius: 10px;"></input>
				</div>
				<div style="margin-left: 5px; margin-right: 5px; margin-bottom:5px;" id="pages">
				</div>
			</span>
			<div style="margin: 5px;" id="6str">
			</div>
			<div style="margin: 5px;" id="7str">
				<textarea class="${exttheme}" style="width: 341px; border-radius: 10px; min-height: 100px; max-height: 350px; resize: vertical;" id="inp"></textarea>
			<div id="hyperlnk" class="hyperlnk">
				<input id="bindlinktotext" class="${exttheme}" type="text" placeholder="Enter your link üîó here" style="margin-bottom:5px;width:270px;text-align:center;border-radius: 10px;" title="–í–≤–æ–¥–∏—Ç–µ –≤ —ç—Ç–æ –ø–æ–ª–µ —Å—Å—ã–ª–∫—É, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤ –æ–±—â–µ–º –ø–æ–ª–µ –≤—ã–¥–µ–ª—è–µ—Ç–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É –∏ –∫–Ω–æ–ø–∫–æ–π Insert –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ —Å—Å—ã–ª–∫—É –≤ —Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞"></input>
				<button class="mainButton" id="insertlinktotext" title="–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –∏–∑ –ø–æ–ª—è —Å–ª–µ–≤–∞ –≤ –≤—ã–¥–µ–ª–µ–Ω–æ–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É –≤ —Ç–µ–∫—Å—Ç–µ —à–∞–±–ª–æ–Ω–∞">Insert ‚úÖ</button>
			</div>
            <button class="mainButton" title="–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ" id="msg1" style="width:90px;">–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å</button>
            <button class="mainButton msgtype" title="–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–º–µ—Ç–∫–∏ –∏–ª–∏ –≤ —á–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é" id="msg">–ß–∞—Ç</button>
            <button class="mainButton" id="opandclsbarhyper" style="width:  30px; margin: 0; padding: 2px; text-align: center;" title="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –≤ —Ç–µ–∫—Å—Ç">üîó</button>
            <button class="mainButton" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞" id="sndbot" style="width: 30px;">ü§ñ</button>
            <button class="mainButton" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç" id="snd" style="width:40px; background: ForestGreen;">Send</button>
            <button class="mainButton" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ –ª–∏—á–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã" id="addtocusttmplt" style="width: 30px;">‚¨ÜÔ∏è</button>
            <button class="mainButton onlyfortp" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Vimbot" id="openVimbotWindows">‚ñ∂Ô∏è</button>
			</div>
		<div style="border: 2px double black; display: none; background-color: #464451; cursor: -webkit-grab;" id="addTmp">
			<div style="margin: 5px; width: 350px">
			</div>
		</div>
	</span>
</div>`;

const wintAF = createWindow('AF_helper', 'winTopAF', 'winLeftAF', win_AFhelper);

function replaceSelectedText(elem, str) { //—Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∏
    elem.focus();

    if (document.selection) {
        var s = document.selection.createRange();
        if (s.text) {
            s.text = window[str](s.text);
            s.select();
            return true;
        }
    } else if (typeof (elem.selectionStart) == "number") {
        if (elem.selectionStart != elem.selectionEnd) {
            var start = elem.selectionStart;
            var end = elem.selectionEnd;

            var rs = window[str](elem.value.substr(start, end - start));
            elem.value = elem.value.substr(0, start) + rs + elem.value.substr(end);
            elem.setSelectionRange(end, end);
        }
        return true;
    }
    return false;
}

function change_str(s) { // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–∞ –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω—è—è –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–∞–º —Ç–µ–∫—Å—Ç
    return `<a href="${document.getElementById('bindlinktotext').value}" target="_blank" rel="noopener">` + s + "</a>";
}

if (localStorage.getItem('msg') != null) {
    document.getElementById('msg').innerHTML = localStorage.getItem('msg')
    if (localStorage.getItem('msg') == '–ß–∞—Ç')
        document.getElementById('msg').classList.remove('notes')
    else if (localStorage.getItem('msg') == '–ó–∞–º–µ—Ç–∫–∏')
        document.getElementById('msg').classList.add('notes')
}

if (localStorage.getItem('msg1') != null) {
    document.getElementById('msg1').innerHTML = localStorage.getItem('msg1')
}

document.getElementById('msg').onclick = function () { //  –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç –∏–ª–∏ –∑–∞–º–µ—Ç–∫–∏
    if (this.innerHTML == "–ß–∞—Ç") {
        this.innerHTML = "–ó–∞–º–µ—Ç–∫–∏";
        this.classList.toggle('notes')
        localStorage.setItem('msg', '–ó–∞–º–µ—Ç–∫–∏')
    } else {
        this.innerHTML = "–ß–∞—Ç";
        this.classList.toggle('notes')
        localStorage.setItem('msg', '–ß–∞—Ç')
    }
}

document.getElementById('msg1').onclick = function () { //  –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    if (this.innerHTML == "–û—Ç–ø—Ä–∞–≤–∏—Ç—å") {
        this.innerHTML = "–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å";
        localStorage.setItem('msg1', '–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å')
    } else {
        this.innerHTML = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å";
        localStorage.setItem('msg1', '–û—Ç–ø—Ä–∞–≤–∏—Ç—å')
    }
}

document.getElementById('snd').onclick = function () { //—Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç –∏–ª–∏ –∑–∞–º–µ—Ç–∫–∏
    const inp = document.getElementById('inp');
    const phoneTr = document.getElementById('phone_tr');
    const emailTr = document.getElementById('email_tr');
    const snd = document.getElementById('snd');

    snd.setAttribute('disabled', 'disabled');
    setTimeout(function () { snd.removeAttribute('disabled') }, 500);

    if (document.getElementById('msg').innerHTML === '–ß–∞—Ç') {
        if (template_flag === 1) {
            if (template_flag2 === 1) {
                sendAnswerTemplate2(inp.value, 1);
            } else {
                sendAnswerTemplate('', '', 1, inp.value, 1);
            }
        } else {
            sendAnswer(inp.value, 0);
        }
    } else {
        sendComment(inp.value);
    }

    inp.value = '';
    if (phoneTr) phoneTr.value = '';
    if (emailTr) emailTr.value = '';
};

document.getElementById('opandclsbarhyper').onclick = function () { // —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∏
    if (document.getElementById('hyperlnk').classList.contains('hyper-active') == false) {
        document.getElementById('hyperlnk').classList.add('hyper-active')
        document.getElementById('hyperlnk').classList.remove('hyperlnk')
    } else {
        document.getElementById('hyperlnk').classList.remove('hyper-active')
        document.getElementById('hyperlnk').classList.add('hyperlnk')
    }
}

document.getElementById('insertlinktotext').onclick = function () { // —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—ã —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫—É
    replaceSelectedText(document.getElementById('inp'), 'change_str');
    document.getElementById('bindlinktotext').value = ''
    document.getElementById('hyperlnk').classList.remove('hyper-active')
    document.getElementById('hyperlnk').classList.add('hyperlnk')
}

document.getElementById('sndbot').onclick = async function () { //–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–≤—Ç–æ—Ñ–∞–∫ –±–æ—Ç–∞
    const inp = document.getElementById('inp');
    const phoneTr = document.getElementById('phone_tr');
    const emailTr = document.getElementById('email_tr');
    const txt = inp.value;
    var values = await getInfo(flag)
    var adr = values[0]; var adr1 = values[1]; var uid = values[2]
    var txt2 = txt.split('\n')
    var txt3 = ""
    txt2.forEach(el => txt3 += "<p>" + el + "</p>\\n")
    txt3 = txt3.split("\"").join("\\\"")
    txt3 = txt3.split('<p></p>').join("<p><br></p>")
    txt3 = txt3.substr(0, txt3.length - 2)

    if (document.getElementById('msg').innerHTML == "–ß–∞—Ç")
        fetch("https://skyeng.autofaq.ai/api/reason8/answers", {
            "headers": {
                "content-type": "multipart/form-data; boundary=----WebKitFormBoundarymasjvc4O46a190zh",
                "x-csrf-token": aftoken
            },
            "body": "------WebKitFormBoundarymasjvc4O46a190zh\r\nContent-Disposition: form-data; name=\"payload\"\r\n\r\n{\"sessionId\":\"" + uid + "\",\"conversationId\":\"" + adr1 + "\",\"text\":\"" + txt3 + "\",\"suggestedAnswerDocId\":0}\r\n------WebKitFormBoundarymasjvc4O46a190zh--\r\n",
            "method": "POST",
            "credentials": "include"
        });

    inp.value = '';
    if (phoneTr) phoneTr.value = '';
    if (emailTr) emailTr.value = '';
}

document.getElementById('hideMenuMain').onclick = function () { // –∫–Ω–æ–ø–∫–∞ hide –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –æ–∫–Ω–µ —Å–∫—Ä–∏–ø—Ç–∞
    var elements = ['AF_helper', 'AF_CustomTemplates', 'AF_Links', 'AF_AlarmClock', 'AF_Stat', 'AF_LessonStatus', 'AF_Linksd', 'AF_Settings'];
    elements.forEach(e => { if (document.getElementById(e)) { setDisplayStyle(document.getElementById(e), 'none') } });
    document.getElementById('scriptBut').classList.remove('activeScriptBtn')
}

document.getElementById('getnewtmpldata').onclick = getText // –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞